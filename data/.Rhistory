# create a new data frame with only the joined columns
alc <- select(math_por, one_of(join_by))
# the columns in the datasets which were not used for joining the data
notjoined_columns <- colnames(math)[!colnames(math) %in% join_by]
# print out the columns not used for joining
notjoined_columns
# for every column name not used for joining...
for(column_name in notjoined_columns) {
# select two columns from 'math_por' with the same original name
two_columns <- select(math_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else { # else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
write.csv(alc,file="alc.csv",row.names=FALSE)
?write.csv
library(dplyr)
alc<-read.table("alc.csv",header=FALSE,sep=",")
View(alc)
library(dplyr)
alc<-read.table("alc.csv",header=TRUE,sep=",")
View(alc)
colnames(alc)
---
title: "Chapter3"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Chapter 3 - Analysis
```
library(dplyr)
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
```
getwd
colnames(alc)
getwd
getwd()
knitr::opts_chunk$set(echo = TRUE)
```{r}
library(dplyr)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","g3","high_use")
data <- one_of(alc,columns)
library(dplyr)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","g3","high_use")
data <- select(alc,one_of(columns))
library(dplyr)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","G3","high_use")
data <- select(alc,one_of(columns))
View(data)
library(ggplot2)
library(dplyr)
library(ggplot2)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","G3","high_use")
data <- select(alc,one_of(columns))
# initialize a plot of high_use and G3
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
# define the plot as a boxplot and draw it
g1 + geom_boxplot() + ylab("grade")
# initialise a plot of high_use and absences
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
# define the plot as a boxplot and draw it
g2 + geom_boxplot() + ggtitle("Student absences by alcohol consumption and sex")
g2
g2
ggplot(high_use,health,data=mpg)
ggplot(data(high_use),data(health),data=mpg)
ggplot(data[high_use],data[health],data=mpg)
qplot(data[high_use],data[health],data=mpg)
qplot(alc, aes(x = high_use, y = G3, col = sex))
ggplot(alc, aes(x = high_use, y = G3))
ggplot(alc, aes(x = high_use, y = G3))+ geom_boxplot() + ylab("grade")
g1 + geom_dotplot() + ylab("grade")
g1 + geom_histogram() + ylab("grade")
ggplot(alc, aes(x = high_use, y = G3))+ geom_histogram()
ggplot(alc, aes(x = high_use, y = G3))+ geom_boxplot() + ylab("grade")
ggplot(alc, aes(x = G3, y = high_use))+ geom_boxplot() + ylab("grade")
ggplot(alc, aes(x = G3, y = high_use))
ggplot(alc, aes(x = G3, y = high_ulse))
ggplot(alc, aes(x = G3, y = high_use))
qplot(alc, aes(x = G3, y = high_use))
ggplot(alc, x = G3, y = high_use)
qplot(alc, x = G3, y = high_use)
qplot(data=alc, x = G3, y = high_use)
qplot(data=alc, x = G3, y = high_use)+geom_histogram()
ggplot(data=alc, x = G3, y = high_use)+geom_histogram()
qplot(alc$G3, geom="histogram")
qplot(alc$G3&&high_use=TRUE, geom="histogram")
qplot(alc$G3&&high_use==TRUE, geom="histogram")
qplot(alc$G3&&alc$high_use==TRUE, geom="histogram")
qplot(alc$G3&&alc$high_use==TRUE,stat="count", geom="histogram")
qplot(alc$G3&&alc$high_use==TRUE, geom="histogram")+stat_bin("count")
ggplot(alc$G3&&alc$high_use==TRUE, geom="histogram")+stat_bin("count")
ggplot2.histogram(alc$G3&&alc)
ggplot2.histogram(data=alc,alc$G3&&alc)
ggplot2.histogram(data=alc$high_use)
qplot(alc$G3&&alc$high_use==TRUE, geom="histogram")
qplot(alc$G3&&(alc$high_use==TRUE), geom="histogram")
ggplot(data=alc,aes(x=G3,y=high_use))
ggplot(data=alc,aes(x=G3,y=high_use))+geom_histogram()
ggplot(data=alc,aes(x=G3,x=high_use))+geom_histogram()
ggplot(data=alc,aes(x1=G3,x2=high_use))+geom_histogram()
ggplot(data=alc,aes(x=G3,x=high_use))+geom_histogram()
ggplot(data=alc,aes(x=G3))+geom_histogram()
ggplot(data=alc,aes(x=G3))+geom_histogram()+stat_bin(bins=14)
ggplot(data=alc,aes(x=G3))+geom_histogram()+stat_bin(binwidth=14)
ggplot(data=alc,aes(x=G3))+geom_histogram()+stat_bin(binwidth=1)
ggplot(data=alc,aes(x=G3))+geom_histogram()
ggplot(data=alc,groupName=high_use,aes(x=G3))+geom_histogram()
ggplot(data=alc,groupName=high_use,aes(x=G3))+geom_histogram()
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram()
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(aes(col=high_use))
ggplot(data=alc,aes(x=G3)+geom_histogram(aes(col=high_use))
ggplot(data=alc,aes(x=G3)+geom_histogram(aes(col=high_use))
qplot(data=alc,aes(x=G3)+geom_histogram(aes(col=high_use))
ggplot(data=alc,aes(x=G3,col=high_use)+geom_histogram(binwidth=2)
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=2)
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=1)
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=1,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.5,position="jitter")
dodge
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=10,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=2,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
count(alc$high_use)
library(dplyr)
count(alc$high_use==TRUE)
length(alc$high_use==TRUE)
length(alc$high_use==FALSE)
length(alc[alc$high_use==TRUE])
length(alc$high_use==TRUE)
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
mean(alc$G3)
mean(alc$G3 && alc$high_use==FALSE)
mean(alc$G3)
mean(alc$G3)
mean(alc$G3)
mean(alc$romantic)
sum(alc$romantic)
sum(alc$romantic==TRUE)
sum(alc$romantic=="no")
sum(alc$romantic=="no" && alc$high_use=="TRUE")
sum(alc$romantic=="no" && alc$high_use=="FALSE")
(alc$romantic=="no" && alc$high_use=="FALSE")
HU<-alc(high_use=="TRUE")
HU<-alc(alc$high_use=="TRUE")
HU<-alc[alc$high_use=="TRUE"]
HU<-(alc$romantic=="no" && alc$high_use=="FALSE")
HU<-c(alc$romantic=="no" && alc$high_use=="FALSE")
HU<-subset(alc,alc$high_use=="FALSE")
View(HU)
#Start with numeric valuation.
LU<-subset(alc,alc$high_use=="FALSE")
HU<-subset(alc,alc$high_use=="TRUE")
mean(LU$G3)
mean(HU$G3)
LU<-subset(alc,alc$high_use=="FALSE")
HU<-subset(alc,alc$high_use=="TRUE")
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$romantic)
mean(HU$romantic)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic)
sum(HU$romantic)
sum(LU$romantic=="no")
sum(HU$romantic=="yes")
sum(LU$romantic=="no")
sum(LU$romantic=="yes")
sum(HU$romantic=="no")
sum(HU$romantic=="yes")
sum(LU$romantic=="no")/sum(LU$romantic=="yes")
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
sum(LU)
sum(LU)
length(LU)
width(LU)
row_number(LU)
nrow(LU)
nrow(HU)
ggplot(data=alc,aes(x=G3*nrow(LU)/nrow(alc),col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
library(dplyr)
library(ggplot2)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","G3","high_use")
data <- select(alc,one_of(columns))
# initialize a plot of high_use and G3
ggplot(data=alc, x = G3, y = high_use)+geom_histogram()
qplot(alc$G3&&(alc$high_use==TRUE), geom="histogram")
# define the plot as a boxplot and draw it
g1 + geom_histogram() + ylab("grade")
# initialise a plot of high_use and absences
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2
# define the plot as a boxplot and draw it
g2 + geom_boxplot() + ggtitle("Student absences by alcohol consumption and sex")
qplot(alc, aes(x = high_use, y = G3, col = sex))
LU<-subset(alc,alc$high_use=="FALSE")
HU<-subset(alc,alc$high_use=="TRUE")
ggplot(data=alc,aes(x=G3*nrow(LU)/nrow(alc),col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
nrow(LU)
nrow(HU)
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
nrow(alc)
ggplot(data=alc,aes(x=G3/nrow(alc),col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3*nrow(LU)/nrow(alc),col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use,y=G3))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.5,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=0.75,position="dodge")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=1,position="dodge")
ggplot(data=alc,aes(x=G3)+geom_histogram(binwidth=1)
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
nrow(alc)
nrow(LU)
nrow(HU)
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
ggplot(data=alc,aes(x=G3)+geom_histogram(binwidth=1)
qplot(data=alc,aes(x=G3)+geom_histogram(binwidth=1)
qplot(data=alc,aes(x=G3)
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
nrow(alc)
nrow(LU)
nrow(HU)
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
gather(LU)
gather(LU)
library(dplyr)
library(tidyr)
library(ggplot2)
getwd()
alc<-read.table("alc.csv",header=TRUE,sep=",")
colnames(alc)
columns<-c("romantic","studytime","health","G3","high_use")
data <- select(alc,one_of(columns))
# initialize a plot of high_use and G3
ggplot(data=alc, x = G3, y = high_use)+geom_histogram()
qplot(alc$G3&&(alc$high_use==TRUE), geom="histogram")
# define the plot as a boxplot and draw it
g1 + geom_histogram() + ylab("grade")
# initialise a plot of high_use and absences
g2 <- ggplot(alc, aes(x = high_use, y = absences, col = sex))
g2
# define the plot as a boxplot and draw it
g2 + geom_boxplot() + ggtitle("Student absences by alcohol consumption and sex")
qplot(alc, aes(x = high_use, y = G3, col = sex))
LU<-subset(alc,alc$high_use=="FALSE")
HU<-subset(alc,alc$high_use=="TRUE")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=1,position="dodge")
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
nrow(alc)
nrow(LU)
nrow(HU)
gather(LU)
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
gather(LU)
gather(alc)
gather(alc) %>% glimpse
library(dplyr)
library(tidyr)
library(ggplot2)
install.packages("tidyr")
gather(alc) %>% glimpse
library(tidyr)
gather(alc) %>% glimpse
gather(HU) %>% glimpse
gather(alc) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free")
gather(HU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free")
gather(HU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(HU) %>% glimpse
HU
gather(HU(columns)) %>% glimpse
gather(HU(columns)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
LU<-subset(data,alc$high_use=="FALSE")
HU<-subset(data,alc$high_use=="TRUE")
ggplot(data=alc,aes(x=G3,col=high_use))+geom_histogram(binwidth=1,position="dodge")
sum(alc$high_use==TRUE)
sum(alc$high_use==FALSE)
nrow(alc)
nrow(LU)
nrow(HU)
gather(HU(columns)) %>% glimpse
gather(HU(columns)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
LU<-subset(data,alc$high_use=="FALSE")
HU<-subset(data,alc$high_use=="TRUE")
View(LU)
nrow(LU)
gather(HU(columns)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
gather(HU(columns)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
mean(LU$G3)
mean(HU$G3)
mean(LU$health)
mean(HU$health)
mean(LU$studytime)
mean(HU$studytime)
sum(LU$romantic=="yes")/sum(LU$romantic=="no")
sum(HU$romantic=="yes")/sum(HU$romantic=="no")
gather(HU(columns)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU(columns)) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(HU)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
LU<-subset(data,data$high_use=="FALSE")
HU<-subset(data,data$high_use=="TRUE")
gather(HU)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(HU)= %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(LU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
gather(HU) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
glm(high_use ~ failures + absences + sex, data = alc, family = "binomial")
coefficients(a)
summary(a)
a<-glm(high_use ~ failures + absences + sex, data = alc, family = "binomial")
summary(a)
coef(a)
a<-glm(high_use ~ health + G3 + studytime, data = alc, family = "binomial")
summary(a)
coef(a)
a<-glm(high_use ~ health + G3 + studytime+romantic, data = alc, family = "binomial")
summary(a)
coef(a)
exp(0.06)
exp(summary(a)$coefficients)
exp(summary(a)$coefficients)
exp(0.06049458)
exp(-0.06490750)
exp(-0.54301860)
exp(-0.20472927)
exp(summary(m)$coefficients[] +
+     qnorm(c(0.025,0.5,0.975)) * summary(m)$coefficients[])
exp(summary(a)$coefficients[] +
+     qnorm(c(0.025,0.5,0.975)) * summary(a)$coefficients[])
exp(summary(a)$coefficients[] +     qnorm(c(0.025,0.5,0.975)) * summary(a)$coefficients[])
exp(summary(a)$coefficients[]
exp(summary(a)$coefficients[])
exp(summary(a)$coefficients)
summary(a)$coefficients
summary(a)$coefficients[,2]
exp(summary(a)$coefficients)
exp(0.06049458)
exp(-0.06490750)
exp(-0.54301860)
exp(-0.20472927)
summary(a)$coefficients[,2]
summary(a)$coefficients[,2]*qnorm(c(0.025,0.5,0.975))
summary(a)$coefficients[1,2]*qnorm(c(0.025,0.5,0.975))
summary(a)$coefficients[2,2]*qnorm(c(0.025,0.5,0.975))
summary(a)
summary(a)$coefficients[,2]*qnorm(c0.025)
summary(a)$coefficients[,2]*qnorm(0.025)
summary(a)$coefficients[,2]*qnorm(0.975)
coef(a)
exp(summary(a)$coefficients)
exp(0.06049458)
exp(-0.06490750)
exp(-0.54301860)
exp(-0.20472927)
exp(summary(a)$coefficients)+summary(a)$coefficients[,2]*qnorm(0.025)
exp(summary(a)$coefficients)+summary(a)$coefficients[,2]*qnorm(0.975)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.025)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975)
coef(a)
exp(summary(a)$coefficients)
exp(0.06049458)
exp(-0.06490750)
exp(-0.54301860)
exp(-0.20472927)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.025)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975)
exp(summary(a)$coefficients)
exp(summary(a)$coefficients,[,1])
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.025)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975)
exp(summary(a)$coefficients[,1])
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(c(0.025,0.5,0.975)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(c(0.025,0.5,0.975)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975)
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(c(0.025,0.5,0.975))
exp(summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.025)
coef(a) %>% exp
confint(m) %>% exp
confint(a) %>% exp
exp(summary(a)$coefficients[,1])
exp((summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.025))
exp((summary(a)$coefficients[,1])+summary(a)$coefficients[,2]*qnorm(0.975))
coef(a) %>% exp
confint(a) %>% exp
m <- glm(high_use ~ failures + absences + sex, data = alc, family = "binomial")
# predict() the probability of high_use
probabilities <- predict(m, type = "response")
# alc, dplyr are available
# fit the model
m <- glm(high_use ~ studytime, data = alc, family = "binomial")
# predict() the probability of high_use
probabilities <- predict(m, type = "response")
# add the predicted probabilities to 'alc'
alc <- mutate(alc, probability = probabilities)
# use the probabilities to make a prediction of high_use
alc <- mutate(alc, prediction = probability > 0.5)
# see the last ten original classes, predicted probabilities, and class predictions
select(alc, studytime high_use, probability, prediction) %>% tail(10)
# tabulate the target variable versus the predictions
table(high_use = alc$high_use, prediction = alc$prediction)
# fit the model
m <- glm(high_use ~ studytime, data = alc, family = "binomial")
# predict() the probability of high_use
probabilities <- predict(m, type = "response")
# add the predicted probabilities to 'alc'
alc <- mutate(alc, probability = probabilities)
# use the probabilities to make a prediction of high_use
alc <- mutate(alc, prediction = probability > 0.5)
# see the last ten original classes, predicted probabilities, and class predictions
select(alc, studytime, high_use, probability, prediction) %>% tail(10)
# tabulate the target variable versus the predictions
table(high_use = alc$high_use, prediction = alc$prediction)
alc
table(high_use = alc$high_use, prediction = alc$prediction)
View(alc)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
# call loss_func to compute the average number of wrong predictions in the (training) data
loss_func(class = alc$high_use, prob = alc$probability)
n_wrong
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
n_wrong
}
loss_func(class = alc$high_use, prob = alc$probability)
write.csv(alc,file="alc.csv",row.names=FALSE)
